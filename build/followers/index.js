(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,a=window.wp.element,l=window.wp.primitives,n=(0,a.createElement)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(l.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"}));function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r.apply(this,arguments)}const o=window.wp.components,c=window.wp.data,s=window.wp.blockEditor,i=window.wp.i18n,u=window.React,p=window.wp.apiFetch;var w=e.n(p);const v=window.wp.url;function m(e){let{selectedUser:t,per_page:l,order:n,title:r,page:o,setPage:c}=e;const s="site"===t?0:t,[i,p]=(0,u.useState)([]),[m,b]=(0,u.useState)(0),[h,E]=(0,u.useState)(0);return(0,u.useEffect)((()=>{const e=function(e,t,a,l){const n=`/activitypub/1.0/users/${e}/followers`,r={per_page:t,order:a,page:l,context:"view"};return(0,v.addQueryArgs)(n,r)}(s,l,n,o);w()({path:e}).then((e=>{b(e.total_pages),E(e.total),p(e.followers)})).catch((e=>console.error(e)))}),[s,l,n,o]),(0,a.createElement)("div",{className:"activitypub-follower-block"},(0,a.createElement)("h3",null,r),(0,a.createElement)("ul",null,i&&i.map((e=>(0,a.createElement)("li",{key:e.url},(0,a.createElement)(g,e))))),(0,a.createElement)(d,{pages:m,page:o,setPage:c,total:h,per_page:l}))}function d(e){let{pages:t,page:l,setPage:n,total:r,per_page:o}=e;const c=l<t,s=l>1,i=(l-1)*o+1,u=l*o>r?r:l*o;return t>1?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("span",null,i,"-",u," / ",r," Followers"),s&&(0,a.createElement)("button",{onClick:()=>n(l-1)},"🔙Prev"),c&&(0,a.createElement)("button",{onClick:()=>n(l+1)},"Next➡️")):null}function g(e){let{name:t,avatar:l,url:n,handle:r}=e;return(0,a.createElement)("a",{href:n,title:r,onClick:e=>e.preventDefault()},(0,a.createElement)("img",{width:"40",height:"40",src:l,class:"avatar activitypub-avatar"}),(0,a.createElement)("span",{class:"activitypub-actor"},(0,a.createElement)("strong",null,t),(0,a.createElement)("span",{class:"sep"},"/"),r))}(0,t.registerBlockType)("activitypub/followers",{edit:function(e){let{attributes:t,setAttributes:l}=e;const{order:n,per_page:u,selectedUser:p}=t,w=(0,s.useBlockProps)(),[v,d]=(0,a.useState)(1),g=[{label:(0,i.__)("New to old","activitypub"),value:"desc"},{label:(0,i.__)("Old to new","activitypub"),value:"asc"}],b=(0,c.useSelect)((e=>e("core").getUsers({who:"authors"}))),h=(0,a.useMemo)((()=>b?b.reduce(((e,t)=>(e.push({label:t.name,value:t.id}),e)),[{label:"Whole Site",value:"site"}]):[]),[b]),E=e=>t=>{d(1),l({[e]:t})};return(0,a.createElement)("div",w,(0,a.createElement)(s.InspectorControls,{key:"setting"},(0,a.createElement)(o.PanelBody,{title:(0,i.__)("Followers Options","activitypub")},(0,a.createElement)(o.SelectControl,{label:"Select User",value:p,options:h,onChange:E("selectedUser")}),(0,a.createElement)(o.SelectControl,{label:(0,i.__)("Sort","activitypub"),value:n,options:g,onChange:E("order")}),(0,a.createElement)(o.RangeControl,{label:(0,i.__)("Number of Followers","activitypub"),value:u,onChange:E("per_page"),min:1,max:10}))),(0,a.createElement)(m,r({},t,{page:v,setPage:d})))},save:()=>null,icon:n})})();