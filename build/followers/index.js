(()=>{"use strict";var e={n:t=>{var l=t&&t.__esModule?()=>t.default:()=>t;return e.d(l,{a:l}),l},d:(t,l)=>{for(var a in l)e.o(l,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:l[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,l=window.wp.element,a=window.wp.primitives,n=(0,l.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(a.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})),r=window.wp.components,o=window.wp.data,c=window.wp.blockEditor,s=window.wp.i18n,i=window.React,u=window.wp.apiFetch;var p=e.n(u);const w=window.wp.url;function m(e){let{selectedUser:t,per_page:a,order:n,title:r}=e;const o="site"===t?0:t,[c,s]=(0,i.useState)([]),[u,m]=(0,i.useState)(0),[g,b]=(0,i.useState)(1),[h,E]=(0,i.useState)(0);return(0,i.useEffect)((()=>{const e=function(e,t,l,a){const n=`/activitypub/1.0/users/${e}/followers`,r={per_page:t,order:l,page:a,context:"view"};return(0,w.addQueryArgs)(n,r)}(o,a,n,g);p()({path:e}).then((e=>{m(e.total_pages),E(e.total),s(e.followers)})).catch((e=>console.error(e)))}),[o,a,n,g]),(0,l.createElement)("div",{className:"activitypub-follower-block"},(0,l.createElement)("h3",null,r),(0,l.createElement)("ul",null,c&&c.map((e=>(0,l.createElement)("li",{key:e.url},(0,l.createElement)(d,e))))),(0,l.createElement)(v,{pages:u,page:g,setPage:b,total:h,per_page:a}))}function v(e){let{pages:t,page:a,setPage:n,total:r,per_page:o}=e;const c=a<t,s=a>1,i=(a-1)*o+1,u=a*o>r?r:a*o;return t>1?(0,l.createElement)(l.Fragment,null,(0,l.createElement)("span",null,i,"-",u," / ",r," Followers"),s&&(0,l.createElement)("button",{onClick:()=>n(a-1)},"🔙Prev"),c&&(0,l.createElement)("button",{onClick:()=>n(a+1)},"Next➡️")):null}function d(e){let{name:t,avatar:a,url:n,handle:r}=e;return(0,l.createElement)("a",{href:n,title:r,onClick:e=>e.preventDefault()},(0,l.createElement)("img",{width:"40",height:"40",src:a,class:"avatar activitypub-avatar"}),(0,l.createElement)("span",{class:"activitypub-actor"},(0,l.createElement)("strong",null,t),(0,l.createElement)("span",{class:"sep"},"/"),r))}(0,t.registerBlockType)("activitypub/followers",{edit:function(e){let{attributes:t,setAttributes:a}=e;const{order:n,per_page:i,selectedUser:u}=t,p=(0,c.useBlockProps)(),w=[{label:(0,s.__)("New to old","activitypub"),value:"desc"},{label:(0,s.__)("Old to new","activitypub"),value:"asc"}],v=(0,o.useSelect)((e=>e("core").getUsers({who:"authors"}))),d=(0,l.useMemo)((()=>v?v.reduce(((e,t)=>(e.push({label:t.name,value:t.id}),e)),[{label:"Whole Site",value:"site"}]):[]),[v]);return(0,l.createElement)("div",p,(0,l.createElement)(c.InspectorControls,{key:"setting"},(0,l.createElement)(r.PanelBody,{title:(0,s.__)("Followers Options","activitypub")},(0,l.createElement)(r.SelectControl,{label:"Select User",value:u,options:d,onChange:e=>a({selectedUser:e})}),(0,l.createElement)(r.SelectControl,{label:(0,s.__)("Sort","activitypub"),value:n,options:w,onChange:e=>a({order:e})}),(0,l.createElement)(r.RangeControl,{label:(0,s.__)("Number of Followers","activitypub"),value:i,onChange:e=>a({per_page:e}),min:1,max:10}))),(0,l.createElement)(m,t))},save:()=>null,icon:n})})();