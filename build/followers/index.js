(()=>{"use strict";var e={n:t=>{var l=t&&t.__esModule?()=>t.default:()=>t;return e.d(l,{a:l}),l},d:(t,l)=>{for(var a in l)e.o(l,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:l[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,l=window.wp.element,a=window.wp.primitives,o=(0,l.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(a.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})),n=window.wp.components,r=window.wp.data,c=window.wp.blockEditor,i=window.wp.i18n,s=window.React,u=window.wp.apiFetch;var w=e.n(u);function v(e){let{selectedUser:t,followersToShow:a,title:o}=e;const n="site"===t?0:t,[r,c]=(0,s.useState)([]);return(0,s.useEffect)((()=>{w()({path:`/activitypub/1.0/users/${n}/followers?context=view`}).then((e=>c(e))).catch((e=>console.error(e)))}),[n]),(0,l.createElement)("div",{className:"activitypub-follower-block"},(0,l.createElement)("h3",null,o),(0,l.createElement)("ul",null,r&&r.map((e=>(0,l.createElement)("li",{key:e.id},(0,l.createElement)(p,e))))))}function p(e){let{name:t,avatar:a,url:o,handle:n}=e;return(0,l.createElement)("a",{href:o,title:n,onClick:e=>e.preventDefault()},(0,l.createElement)("img",{width:"40",height:"40",src:a,class:"avatar activitypub-avatar"}),(0,l.createElement)("span",{class:"activitypub-actor"},(0,l.createElement)("strong",null,t),(0,l.createElement)("span",{class:"sep"},"/"),n))}(0,t.registerBlockType)("activitypub/followers",{edit:function(e){let{attributes:t,setAttributes:a}=e;const{selectedUser:o,followersToShow:s,sort:u}=t,w=(0,c.useBlockProps)(),p=[{label:(0,i.__)("New to old","activitypub"),value:"DESC"},{label:(0,i.__)("Old to new","activitypub"),value:"ASC"}],m=(0,r.useSelect)((e=>e("core").getUsers({who:"authors"}))),d=(0,l.useMemo)((()=>m?m.reduce(((e,t)=>(e.push({label:t.name,value:t.id}),e)),[{label:"Whole Site",value:"site"}]):[]),[m]);return(0,l.createElement)("div",w,(0,l.createElement)(c.InspectorControls,{key:"setting"},(0,l.createElement)(n.PanelBody,{title:(0,i.__)("Followers Options","activitypub")},(0,l.createElement)(n.SelectControl,{label:"Select User",value:o,options:d,onChange:e=>a({selectedUser:e})}),(0,l.createElement)(n.SelectControl,{label:(0,i.__)("Sort","activitypub"),value:u,options:p,onChange:e=>a({sort:e})}),(0,l.createElement)(n.RangeControl,{label:(0,i.__)("Number of Followers","activitypub"),value:s,onChange:e=>a({followersToShow:e}),min:1,max:10}))),(0,l.createElement)(v,t))},save:()=>null,icon:o})})();