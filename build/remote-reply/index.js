(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.domReady;var a=e.n(n);const o=window.wp.apiFetch;var c=e.n(o);const r=window.wp.components,i=window.wp.i18n,l=window.wp.primitives,m=(0,t.createElement)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(l.Path,{d:"M20.2 8v11c0 .7-.6 1.2-1.2 1.2H6v1.5h13c1.5 0 2.7-1.2 2.7-2.8V8zM18 16.4V4.6c0-.9-.7-1.6-1.6-1.6H4.6C3.7 3 3 3.7 3 4.6v11.8c0 .9.7 1.6 1.6 1.6h11.8c.9 0 1.6-.7 1.6-1.6zm-13.5 0V4.6c0-.1.1-.1.1-.1h11.8c.1 0 .1.1.1.1v11.8c0 .1-.1.1-.1.1H4.6l-.1-.1z"})),p=(0,t.createElement)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(l.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})),s=function({icon:e,size:n=24,...a}){return(0,t.cloneElement)(e,{width:n,height:n,...a})},u=window.wp.compose,{namespace:d}=window._activityPubOptions;function v(e){try{return new URL(e),!0}catch(e){return!1}}function y({selectedComment:e,commentId:n}){const a=(0,i.__)("Reply","activitypub"),o=(0,i.__)("Loading...","activitypub"),l=(0,i.__)("Opening...","activitypub"),y=(0,i.__)("Error","activitypub"),w=(0,i.__)("Invalid","activitypub"),[_,h]=(0,t.useState)(a),[E,b]=(0,t.useState)(m),f=(0,u.useCopyToClipboard)(e,(()=>{b(p),setTimeout((()=>b(m)),1e3)})),[g,C]=(0,t.useState)(""),N=(0,t.useCallback)((()=>{let e;if(!v(g)&&!function(e){const t=e.replace(/^@/,"").split("@");return 2===t.length&&v(`https://${t[1]}`)}(g))return h(w),e=setTimeout((()=>h(a)),2e3),()=>clearTimeout(e);const t=`/${d}/comments/${n}/remote-reply?resource=${g}`;h(o),c()({path:t}).then((({url:e})=>{h(l),setTimeout((()=>{window.open(e,"_blank"),h(a)}),200)})).catch((()=>{h(y),setTimeout((()=>h(a)),2e3)}))}),[g]);return(0,t.createElement)("div",{className:"activitypub-follow-me__dialog"},(0,t.createElement)("div",{className:"apmfd__section"},(0,t.createElement)("h4",null,(0,i.__)("The Comment URL","activitypub")),(0,t.createElement)("div",{className:"apfmd-description"},(0,i.__)("Copy and paste the Comment URL into the search field of your favorite fediverse app or server to reply to this Comment.","activitypub")),(0,t.createElement)("div",{className:"apfmd__button-group"},(0,t.createElement)("input",{type:"text",value:e,readOnly:!0}),(0,t.createElement)(r.Button,{ref:f},(0,t.createElement)(s,{icon:E}),(0,i.__)("Copy","activitypub")))),(0,t.createElement)("div",{className:"apmfd__section"},(0,t.createElement)("h4",null,(0,i.__)("Your Profile","activitypub")),(0,t.createElement)("div",{className:"apfmd-description"},(0,t.createInterpolateElement)((0,i.__)("Or, if you know your own profile, we can start things that way! (eg <code>https://example.com/yourusername</code> or <code>yourusername@example.com</code>)","activitypub"),{code:(0,t.createElement)("code",null)})),(0,t.createElement)("div",{className:"apfmd__button-group"},(0,t.createElement)("input",{type:"text",value:g,onKeyDown:e=>{"Enter"===e?.code&&N()},onChange:e=>C(e.target.value)}),(0,t.createElement)(r.Button,{onClick:N},_))))}function w({selectedComment:e,commentId:n}){const[a,o]=(0,t.useState)(!1),c=(0,i.__)("Remote Reply","activitypub");return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("a",{href:"javascript:;",className:"comment-reply-link activitypub-remote-reply__button",onClick:()=>o(!0)},(0,i.__)("Reply on the Fediverse","activitypub")),a&&(0,t.createElement)(r.Modal,{className:"activitypub-remote-reply__modal",onRequestClose:()=>o(!1),title:c},(0,t.createElement)(y,{selectedComment:e,commentId:n})))}let _=1;a()((()=>{[].forEach.call(document.querySelectorAll(".activitypub-remote-reply"),(e=>{const n=JSON.parse(e.dataset.attrs);(0,t.render)((0,t.createElement)(w,{...n,id:"activitypub-remote-reply-link-"+_++,useId:!0}),e)}))}))})();